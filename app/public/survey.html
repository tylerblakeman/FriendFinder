<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Survey</title>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.css">
</head>
<body>
    
        Survey page
        



 
  <div class="container">
    <!--form-->

      <div class="row">
        <form class="col s12">
          <div class="row">
            <div class="input-field col s6">
              <input placeholder="First & Last Name" id="name" type="text" class="validate">
              <label for="full_name">First & Last Name</label>
            </div>
            <div class="input-field col s6">
              <input placeholder="URL" id="photo_URL" type="text" class="validate">
              <label for="photo_URL">Photo URL</label>
            </div>
          </div>
        </form>
      </div>

    <!-- questions -->
    <!-- Question 1 -->
      <hr>
      <div class="row">
      <div class="input-field col s6" id="input-field">
          <select>
            <option value="" disabled selected>Choose your option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="3">4</option>
            <option value="3">5</option>
          </select>
          <label>Materialize Select</label>
      </div>

    <!-- Question 2 -->
      
      <div class="input-field col s6" id="input-field">
          <select>
            <option value="" disabled selected>Choose your option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="3">4</option>
            <option value="3">5</option>
          </select>
          <label>Materialize Select</label>
        </div>    

    <!-- Question 3 -->

      <div class="input-field col s6" id="input-field">
          <select>
            <option value="" disabled selected>Choose your option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="3">4</option>
            <option value="3">5</option>
          </select>
          <label>Materialize Select</label>
        </div>


    <!-- Question 4 -->

      <div class="input-field col s6" id="input-field">
          <select>
            <option value="" disabled selected>Choose your option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="3">4</option>
            <option value="3">5</option>
          </select>
          <label>Materialize Select</label>
        </div>  


  <!-- Question 5 -->

      <div class="input-field col s6" id="input-field">
          <select>
            <option value="" disabled selected>Choose your option</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="3">4</option>
            <option value="3">5</option>
          </select>
          <label>Materialize Select</label>
        </div>



  <!-- Question 6 -->

      <div class="input-field col s6" id="input-field">
        <select>
          <option value="" disabled selected>Choose your option</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
        <label>Materialize Select</label>
      </div>


  <!-- Question 7 -->


      <div class="input-field col s6" id="input-field">
        <select>
          <option value="" disabled selected>Choose your option</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
        <label>Materialize Select</label>
      </div>

  <!-- Question 8 -->

      <div class="input-field col s6" id="input-field">
        <select>
          <option value="" disabled selected>Choose your option</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
        </select>
        <label>Materialize Select</label>
      </div>


  <!-- Question  9 -->


      <div class="input-field col s6" id="input-field">
        <select>
          <option value="" disabled selected>Choose your option</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="3">4</option>
          <option value="3">5</option>
        </select>
        <label>Materialize Select</label>
      </div>


  <!-- Question 10 -->

      <div class="input-field col s6">
        <select>
          <option value="" disabled selected>Choose your option</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
          <option value="3">4</option>
          <option value="3">5</option>
        </select>
        <label class="form-input">Materialize Select</label>
      </div>

    </div>
    <!-- Submit Button-->
    <a data-target="modal" class="submit waves-effect waves-light btn-large modal-trigger">Submit</a>

    <!--Empty Modal-->
    <div id="modal" class="modal container">
      <div class="modal-content">
        <h4 id="modal-title"></h4>
      <img id="friend-image" class="responsive-img" src="">
        <p id = "modal-text"></p>
      </div>
      <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Okay</a>
      </div>
    </div>


  </div>
</div>

<!--Jquery-->
<script
  src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous">
</script>

<!-- Materialize  -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.js"></script>
<script>
    // this is the materialize js for getting the drop down menus to work
      document.addEventListener('DOMContentLoaded', function() {

    var elems = document.querySelectorAll('select');
    var instances = M.FormSelect.init(elems);
    var instance = M.FormSelect.getInstance("input-field");
  });
  //this is materialize js for getting the modal trigger to work on the submit button
  document.addEventListener('DOMContentLoaded', function() {
    var elems = document.querySelectorAll('.modal');
    var instances = M.Modal.init(elems);        
  });
 
</script>
  <script>
  $(".submit").on("click", function(event) {
    event.preventDefault();
    console.log
    if ($(".input-field option:selected").text().includes("Choose") || $("#name") == "" || $("#photo_URL") == "") {
      $('#modal-title').text("There was an error with your input")
      $('#modal-text').text("Fill out the damn form!")
      return;
    }
    else if ($("#photo_URL").val().includes("http://") == false && $("#photo_URL").val().includes("https://") == false && $("#photo_URL").val().includes("www.") == false) {
    $('#modal-title').text("There was an error with your input");
    $('#modal-text').text("Your photo URL is not valid");
    return;
    }
    else {
      //collecting the different scores the user filled out
      var scoresArray = [];
      var scores = $(".input-field option:selected").text().split("");
      scores.forEach(element => {
        scoresArray.push(Number(element));
      });
      var newUser = {
          name: $("#name").val(),
          photo: $("#photo_URL").val(),
          scores: scoresArray
      }
      console.log(newUser);
      $.post("/apiroutes", newUser, function(data){
        if (data) {
          console.log(`this is your new friend${data.matchedFriend}`)
          $('#modal-title').text("Your New Friend");
          $('#modal-text').text(data.matchedFriend);
          $('#friend-image').attr("src", data.matchedPhoto)
          alert(data.matchedPhoto)
        }
        else{
          alert("Nope")
        }
      })
    }




  
  });
  </script>

</body>
</html>